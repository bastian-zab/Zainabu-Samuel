---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<!-- 
    =======================================================================

    This is a working contact form. To receive email, 
    Replace YOUR_ACCESS_KEY_HERE with your actual Access Key.

    Create Access Key here ðŸ‘‰ https://web3forms.com/

    =======================================================================
 -->
<BaseLayout title="Get In Touch" sideBarActiveItemID="contact">
  <div class="flex items-center">
    <div class="container mx-aut">
      <div class="max-w-xl mx-auto my-10 bg-white p-2 rounded-md shadow-sm">
        <div class="text-center">
          <p class="text-black dark:text-black">1. Your Details</p>
        </div>
        <div class="m-7">
          <form
            action="https://api.web3forms.com/submit"
            method="POST"
            id="form"
            class="needs-validation"
            novalidate
          >
            <input
              type="hidden"
              name="access_key"
              value="4459a130-df58-4e21-8d20-734ac5e4e4fe"
            />
            <input
              type="hidden"
              name="subject"
              value="You Have Received A Contact Message From Your Portfolio"
            />
            <input
              type="hidden"
              name="redirect"
              value="zainabu-samuel.pages.dev"
            />
            <input
              type="hidden"
              name="subject"
              value="New Submission from Web3Forms"
            />
            <input
              type="checkbox"
              name="botcheck"
              id=""
              style="display: none;"
            />

            <div class="flex mb-6 space-x-4">
              <div class="w-full md:w-1/2">
                <label
                  for="fname"
                  class="block mb-2 text-sm text-gray-600 dark:text-gray-400"
                  >First Name</label
                >
                <input
                  type="text"
                  name="name"
                  id="first_name"
                  placeholder="John"
                  required
                  class="w-full px-3 py-2 placeholder-gray-300 border-2 border-gray-200 rounded-md focus:outline-none focus:border-black"
                />
                <div
                  class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                >
                  Please provide your first name.
                </div>
              </div>
              <div class="w-full md:w-1/2">
                <label
                  for="lname"
                  class="block mb-2 text-sm text-gray-600 dark:text-gray-600"
                  >Last Name</label
                >
                <input
                  type="text"
                  name="last_name"
                  id="lname"
                  placeholder="Doe"
                  required
                  class="w-full px-3 py-2 placeholder-gray-300 border-2 border-gray-200 rounded-md focus:outline-none focus:border-black"
                />
                <div
                  class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                >
                  Please provide your last name.
                </div>
              </div>
            </div>

            <div class="flex mb-6 space-x-4">
              <div class="w-full md:w-1/2">
                <label
                  for="email"
                  class="block mb-2 text-sm text-gray-600 dark:text-gray-400"
                  >Email Address</label
                >
                <input
                  type="email"
                  name="email"
                  id="email"
                  placeholder="you@company.com"
                  required
                  class="w-full px-3 py-2 placeholder-gray-300 border-2 border-gray-200 rounded-md focus:outline-none focus:border-black"
                />
                <div class="empty-feedback text-red-400 text-sm mt-1">
                  Please provide your email address.
                </div>
                <div class="invalid-feedback text-red-400 text-sm mt-1">
                  Please provide a valid email address.
                </div>
              </div>

              <div class="w-full md:w-1/2">
                <label
                  for="phone"
                  class="block text-sm mb-2 text-gray-600 dark:text-gray-400"
                  >Phone Number</label
                >
                <input
                  type="text"
                  name="phone"
                  id="phone"
                  placeholder="+1 (555) 1234-567"
                  required
                  class="w-full px-3 py-2 placeholder-gray-300 border-2 border-gray-200 rounded-md focus:outline-none focus:border-black"
                />

                <div
                  class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                >
                  Please provide your phone number.
                </div>
              </div>
            </div>



            <div class="text-center m-7">
              <p class="text-black dark:text-black">2. Your Message.</p>
            </div>


              <div class="mb-6">
              

                <textarea
                  rows="5"
                  name="credentials"
                  id="credentials"
                  placeholder="Message"
                  class="w-full px-3 py-2 placeholder-gray-300 border-2 border-gray-200 rounded-md focus:outline-none focus:border-black"
                  required></textarea>
                <div
                  class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                >
                  Please enter your message.
                </div>
              </div>
              <div class="mb-6">
                <button
                  type="submit"
                  class="w-full px-3 py-4 text-white rounded-md dark: bg-black focus:outline-none"
                >
                  Submit
                </button>
              </div>
              <p class="text-base text-center text-gray-400" id="result"></p>
            </div>
          </form>
        </div>
      </div>
    </div>

    <style>
      .invalid-feedback,
      .empty-feedback {
        display: none;
      }

      .was-validated :placeholder-shown:invalid ~ .empty-feedback {
        display: block;
      }

      .was-validated :not(:placeholder-shown):invalid ~ .invalid-feedback {
        display: block;
      }

      .is-invalid,
      .was-validated :invalid {
        border-color: #dc3545;
      }
    </style>

    <script is:inline>
      (function () {
        "use strict";
        /*
         * Form Validation
         */

        // Fetch all the forms we want to apply custom validation styles to
        const forms = document.querySelectorAll(".needs-validation");
        const result = document.getElementById("result");
        // Loop over them and prevent submission
        Array.prototype.slice.call(forms).forEach(function (form) {
          form.addEventListener(
            "submit",
            function (event) {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();

                form.querySelectorAll(":invalid")[0].focus();
              } else {
                /*
                 * Form Submission using fetch()
                 */

                const formData = new FormData(form);
                event.preventDefault();
                event.stopPropagation();
                const object = {};
                formData.forEach((value, key) => {
                  object[key] = value;
                });
                const json = JSON.stringify(object);
                result.innerHTML = "Please wait...";

                fetch("https://api.web3forms.com/submit", {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                    Accept: "application/json",
                  },
                  body: json,
                })
                  .then(async (response) => {
                    let json = await response.json();
                    if (response.status == 200) {
                      result.innerHTML = json.message;
                      result.classList.remove("text-gray-500");
                      result.classList.add("text-green-500");
                    } else {
                      console.log(response);
                      result.innerHTML = json.message;
                      result.classList.remove("text-gray-500");
                      result.classList.add("text-red-500");
                    }
                  })
                  .catch((error) => {
                    console.log(error);
                    result.innerHTML = "Something went wrong!";
                  })
                  .then(function () {
                    form.reset();
                    form.classList.remove("was-validated");
                    setTimeout(() => {
                      result.style.display = "none";
                    }, 5000);
                  });
              }
              form.classList.add("was-validated");
            },
            false
          );
        });
      })();
    </script>
  </div>
</BaseLayout>
